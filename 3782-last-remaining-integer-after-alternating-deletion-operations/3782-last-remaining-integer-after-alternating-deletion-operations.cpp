class Solution {
public:
    union direction { signed int dir : 2; }; // for 2 bits int

    long long lastInteger(long long n) {
        // Okay from what I read the outpur will never be even number that much is obvious
        // so from the start we have half less numbers, but I need to see if there is any patter here so:
        // for 1
        // 1
        // for n = 2
        // 1 2
        // 1 _
        // for n = 3
        // 1 2 3
        // 1 _ 3
        // _ _ 3
        // for 4
        // 1 2 3 4
        // 1 _ 3 _
        // _ _ 3 _
        // for 5
        // 1 2 3 4 5
        // 1 _ 3 _ 5
        // 1 _ _ _ 5
        // 1 _ _ _ _
        // for 6
        // 1 2 3 4 5 6
        // 1 _ 3 _ 5 _
        // 1 _ _ _ 5 _
        // 1 _ _ _ _ _
        // and for 7
        // 1 2 3 4 5 6 7
        // 1 _ 3 _ 5 _ 7
        // _ _ 3 _ _ _ _
        // for 8
        // 1 2 3 4 5 6 7 8
        // 1 _ 3 _ 5 _ 7 _
        // _ _ 3 _ _ _ 7 _
        // _ _ 3 _ _ _ _ _
        // for 9
        // 1 2 3 4 5 6 7 8 9
        // 1 _ 3 _ 5 _ 7 _ 9
        // 1 _ _ _ 5 _ _ _ 9
        // 1 _ _ _ _ _ _ _ 9
        // _ _ _ _ _ _ _ _ 9
        // for 10
        // 1 2 3 4 5 6 7 8 9 10
        // 1 _ 3 _ 5 _ 7 _ 9 _
        // 1 _ _ _ 5 _ _ _ 9 _
        // 1 _ _ _ _ _ _ _ 9 _
        // _ _ _ _ _ _ _ _ 9 _ 
        // for 11
        // 1 2 3 4 5 6 7 8 9 10 11
        // 1 _ 3 _ 5 _ 7 _ 9 _ 11
        // _ _ 3 _ _ _ 7 _ _ _ 11
        // _ _ 3 _ _ _ _ _ _ _ 11
        // _ _ 3 _ _ _ _ _ _ _ _
        // for 13
        // 1 2 3 4 5 6 7 8 9 10 11 12 13
        // 1 _ 3 _ 5 _ 7 _ 9 _ 11 _ 13
        // 1 _ _ _ 5 _ _ _ 9 _ _ _ 13
        // 1 _ _ _ _ _ _ _ 9 _ _ _ __
        // 1 _ _ _ _ _ _ _ _ _ _
        // for 14
        // 1 2 3 4 5 6 7 8 9 10 11 12 13 14
        // 1 _ 3 _ 5 _ 7 _ 9 _ 11 _ 13 _
        // 1 _ _ _ 5 _ _ _ 9 _ _ _ 13 _
        // 1 _ _ _ _ _ _ _ 9 _ _ _ _ _
        // 1 _ _ _ _ _ _ _ _ _ _
        // lets see how it looks for 15
        // 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15
        // 1 _ 3 _ 5 _ 7 _ 9 _ 11 _ 13 _ 15
        // _ _ 3 _ _ _ 7 _ _ _ 11 _ _ _ 15
        // _ _ 3 _ _ _ _ _ _ _ 11 _ _ _ _
        // _ _ _ _ _ _ _ _ _ _ 11 _ _ _ _
        // for 16
        // 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16
        // 1 _ 3 _ 5 _ 7 _ 9 _ 11 _ 13 _ 15 _
        // _ _ 3 _ _ _ 7 _ _ _ 11 _ _ _ 15 _
        // _ _ 3 _ _ _ _ _ _ _ 11 _ _ _ _ _
        // _ _ _ _ _ _ _ _ _ _ 11 _ _ _ _ _
        // Now for lest say 19
        // 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 
        // 1 _ 3 _ 5 _ 7 _ 9 _ 11 _ 13 _ 15 _ 17 _ 19
        // _ _ 3 _ _ _ 7 _ _ _ 11 _ _ _ 15 _ _ _ 19
        // _ _ 3 _ _ _ _ _ _ _ 11 _ _ _ _ _ _ _ 19
        // _ _ 3 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 19
        // _ _ 3 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
        // 1 2 3 4 5 .... 2n - 4 2n - 3 2n - 2 2n - 1 2n
        // 1 3 5 ... 2n - 3 2n - 1
        // Okay i noticed that the output for n is the same for these numbers
        // 1:   1 2 5 6 13 14 17 18 21 22
        // 3:   3 4 7 8 11 12 19 20 23 24
        
        // 1 3 9 11 33 35 41 43
        // 1 3 9 33 35 41 43
        //  2 6 24 2  6  2

        // 2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36
        // 1 3 1 3 9  3  1  11 1  3  1   3  9 11 9  11 33 35
 
//      1           1   0   ##############################
//      2           1   1
//      3           3   0   ##############################
//      4           3   1
//      5           1   4
//      6           1   5
//      7           3   4
//      8           3   5
//      9           9   0   #############################
//      10          9   1
//      11          3   8   
//      12          3   9
//      13          1   12
//      14          1   13
//      15          11  4   #############################
//      16          11  5
//      17          1   16
//      18          1   17
//      19          3   16
//      20          3   17
//      21          1   20
//      22          1   21
//      23          3   20
//      24          3   21
//      25          9   16
//      26          9   17
//      27          11
//      28          11
//      29          9
//      30          9
//      31          11
//      32          11
//      33          33      ####################################
//      34          33
//      35          35      ####################################
//      36          35
//      37          33
//      38          33
//      39          35
//      40          35
//      41          41      ####################################
//      42          41
//      43          43      ####################################
//      44          43
//      45          41
//      46          41
//      47          43
//      48          43
//      49          33
//      50          33
// 1 2 3 4 5 6 7 8 9 10
//  1  3   5   7   9
//    1    5   9
//       1    9
//          9
// 1 2 3 4 5 6 7 8 9 10 11 12
//  1   3   5   7   9   11
//    3       7       11
//        3       11
//            3
// 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45
//  1   3   5   7   9   11   13   15   17   19   21   23   25   27   29   31   33   35   37   39   41   43   45
//      1       5        9        13        17        21        25        29        33        37      41    45
//           1           9                  17                  25                  33                41
//                       9                                      25                                    41
//                                           9                                      41

        long long jump = 1;
        int first = 1;
        long long distance = 2;

        direction dir;
        dir.dir = 1;

        if(n % 2 == 0) --n;

        while(
            distance <= n 
        ) {
            jump += dir.dir * distance * (n / distance);
            // cout << jump << "\n";
            distance *= 2;
            dir.dir = -dir.dir;

        }

        return jump;

    }

};